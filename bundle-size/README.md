# Bundle size action

This GitHub Action compares two webpack compilation stats files and comments on PRs with a description of the difference. It can run against two gh events: pull_request and push.

## Features

- Builds webpack stat files for main and PRs.
- Compares the build stats of main against build stats of the PR
- Reports the result in markdown tables in a PR comment

## Usage

- Add a workflow to your Github repository as in the example below.

## Workflow example
<!-- x-release-please-start-version -->
```yaml
name: Bundle Stats

on:
  workflow_dispatch:
  pull_request:
    branches:
      - main
  push:
    branches:
      - main

permissions:
  contents: write
  pull-requests: write
  actions: read

jobs:
  compare:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - uses: grafana/plugin-actions/bundle-size@bundle-size/v1.1.0
```
<!-- x-release-please-end-version -->

## Options

The following options can be passed to this action:

- `token`: A github token with write access to pull requests and content (defaults to `github.token`).
- `node-version`: The version of node to use (defaults to `20`).
- `threshold`: The minimum entrypoints total percentage difference required to post comments in PRs (defaults to `5`).
- `working-directory`: The working directory to run the action in.
- `main-branch-stats-artifact`: The name of the artifact that contains the main branch stats.

## Troubleshooting

### Main stats artifact could not be found

If you see this warning during bundle size workflow runs it means that the workflow failed to find the github artifact that contains the main branch stats file. The file can be generated by either merging a PR to main, pushing a commit to main, or manually running the workflow with workflow_dispatch.
