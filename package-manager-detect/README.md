# Package manager detect action

This GitHub Action attempts to resolve the Node.js package manager a repo uses and returns a normalised map of commands for subsequent workflow steps to use.

## Features

- Detects package manager based on packageManager field then lock file
- If no package.json is found in the current directory it will traverse up directories to the nearest package.json file

## Usage

- Add a workflow to your Github repository as in the example below.

## Workflow example

<!-- x-release-please-start-version -->

```yaml
name: Run CI

on:
  pull_request:
    branches:
      - main

jobs:
  compare:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - uses: grafana/plugin-actions/package-manager-detect@package-manager-detect/v0.0.1
      - id: "node-pm"

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: ${{ steps.node-pm.outputs.name }}

      - name: Install dependencies
        run: ${{ steps.node-pm.outputs.frozenInstall }}

      - name: Install playwright browsers
        run: ${{ steps.node-pm.outputs.exec }} playwright install

      - name: Run tests
        run: ${{ steps.node-pm.outputs.run }} test

      - name: Build project
        run: ${{ steps.node-pm.outputs.run }} build
```

<!-- x-release-please-end-version -->

## Options

The following options can be passed to this action:

- `working-directory`: The working directory to run the action in.

## Troubleshooting

### Main stats artifact could not be found

If you see this warning during bundle size workflow runs it means that the workflow failed to find the github artifact that contains the main branch stats file. The file can be generated by either merging a PR to main, pushing a commit to main, or manually running the workflow with workflow_dispatch.
